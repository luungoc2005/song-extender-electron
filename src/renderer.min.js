const e=require("electron").ipcRenderer,a=$(".open-file-btn"),r=$(".progress-bar"),i=$(".play-btn"),l=$(".file-warning");var audioPlayer,currentFile="",playDelay=15,pauseDelay=0;const o=require("./js/audioPlayer.min.js"),n=require("./js/chart.min.js");a.click(function(a){e.send("open-file-dialog")}),e.on("selected-file",function(e,a){$(".selected-file").html(`${decodeURIComponent(a)}`),currentFile=a,i.addClass("disabled"),audioPlayer&&audioPlayer.stop()}),e.on("handled-error",function(e,a){if(a)if("string"==typeof a)$(".alert-message").html(a);else{var r="Error: \n";for(var i in a)r+=`${i}=${a[i]}
`;$(".alert-message").html(r)}}),e.on("calc-progress",function(e,a){var i=Math.round(a,2);r.html(`${i}%`),r.css("width",`${i}%`),r.attr("aria-valuenow",i)}),e.on("analyse-result",function(e,a){$(".alert-message").html(""),audioPlayer=null,audioPlayer=new o(currentFile,a),$('[data-toggle="tooltip"]').tooltip(),console.log(`Score cutoff coefficient: ${a.cutoff}`),a.cutoff>7?l.css("visibility","visible"):l.css("visibility","hidden");var r=null,r=new n(a,"svg");r.on("click",function(e){audioPlayer.seekPos(e)});var t=function(){var e=Math.round(audioPlayer.getCurrentPos());r.setChartTime(e),requestAnimationFrame(t)};requestAnimationFrame(t),i.removeClass("disabled"),audioPlayer.startPlay()}),i.on("click",function(){audioPlayer&&audioPlayer.togglePlay()});