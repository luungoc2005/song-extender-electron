function createSourceBuffer(r){switch(format.bitDepth){case 8:return format.signed?new Int8Array(r.buffer):new Uint8Array(r.buffer);case 16:return format.signed?new Int16Array(r.buffer):new Uint16Array(r.buffer);case 32:return format.signed?new Int32Array(r.buffer):new Uint32Array(r.buffer);default:return new Int16Array(r.buffer)}}function createDestBuffer(r){var e=r.length/(format.bitDepth/8)/2;switch(format.bitDepth){case 8:return format.signed?new Int8Array(e):new Uint8Array(e);case 16:return format.signed?new Int16Array(e):new Uint16Array(e);case 32:return format.signed?new Int32Array(e):new Uint32Array(e);default:return new Int16Array(r.length/4)}}const r=require("stream").Transform,e=require("util");var format,AudioDownsampler=function(e){r.call(this,{objectMode:!0}),e.sampleRate/=2,format=e};e.inherits(AudioDownsampler,r),module.exports=AudioDownsampler,AudioDownsampler.prototype._transform=function(r,e,t){if(0===r.length)this.push(null),t();else if(r.length%2!==0)this.push(r),t();else{for(var n=new createSourceBuffer(r),a=new createDestBuffer(r),f=0,u=0;u<n.length;u+=2)a[f]=.5*n[u]+.5*n[u+1],f++;var i=Buffer.from(a.buffer);this.push(i),t()}};