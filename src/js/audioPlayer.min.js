function onSpriteEnd(){u||(s>p-1&&(s=0),c=i.play(`part${s++}`),console.log(`Current pos: ${s}`))}const e=require("events").EventEmitter,o=require("./howler.min.js"),t=require("util"),r=require("url"),a=require("path");let i,l,n,s=0,p=0,u=!1,c=-1;var audioPlayer=function(t,c){e.call(this),n=this,s=0,p=0,u=!1,l=c.groups;var y=function(e,o,t){return e[t]>o[t]?1:e[t]<o[t]?-1:0},f={},g=0;if(l.length>0){l=l.slice(0).sort(function(e,o){return y(e,o,"time1")});for(var m=0;m<l.length;m++)m+1<l.length?(0==m?f[`part${g++}`]=[0,l[m].time2]:f[`part${g++}`]=[l[m].time1,l[m].time2-l[m].time1],f[`part${g++}`]=[l[m].time1,l[m+1].time2-l[m].time1]):f[`part${g++}`]=[l[m].time1,Math.ceil(c.total)-l[m].time1]}console.log(l),p=g;for(var d=0;d<p;d++)f[`part${d}`][0]*=1e3,f[`part${d}`][1]*=1e3;var h=r.format({pathname:t.replace(new RegExp("\\"+a.sep,"g"),"/"),protocol:"file:",slashes:!0});console.log(`Opening file ${h}`),i=new o.Howl({src:h,sprite:f,onend:onSpriteEnd,onloaderror:function(e,o){alert(`Unable to load audio: ${o}`)}}),console.log(f)};t.inherits(audioPlayer,e),module.exports=audioPlayer,audioPlayer.prototype.startPlay=function(e){s=e||s,i&&!i.playing(c)&&(c=i.play(`part${s++}`),console.log(`Current pos: ${s}`))},audioPlayer.prototype.togglePlay=function(e){if(i)switch(e=e||0){case"play":c=i.play();break;case"pause":i.pause();break;default:i.playing(c)?i.pause():c=i.play()}},audioPlayer.prototype.getCurrentPos=function(){return i?i.seek():-1},audioPlayer.prototype.seekPos=function(e){if(i){u=!0,e=e||0;for(var o=-1,t=-1,r=0;r<l.length;r++)if(l[r].time2>e){var a=l[r].time2-e;(t==-1||a<o)&&(t=r,o=a)}if(console.log(`Selected group ${t}`),t==-1)s=p-1,i.stop(),c=i.play(`part${s++}`),i.seek(e);else{var n=l[t].time1;t=-1;for(var y=0;y<p;y++){var f=Math.abs(i._sprite[`part${y}`][0]/1e3-n);if(0==f){t=y;break}}s=t,i.stop(),c=i.play(`part${s-1}`),i.seek(e)}console.log(`Selected sprite ${s}`),u=!1}},audioPlayer.prototype.stop=function(){i&&i.stop()};