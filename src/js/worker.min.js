function sendToMainWindow(e,n){process.send({event:e,path:n})}function onHandledError(e){sendToMainWindow("handled-error",e)}function openFile(u){var f,p=(Buffer.alloc(65536),n.createReadStream(u));switch(e.extname(u).toLowerCase()){case".mp3":var m=require("lame");f=new m.Decoder;break;case".wav":var w=require("wav");f=new w.Reader}f.on("format",function(e){s=new r(e),t=new o(e),c=new a(e,2048),l=new i(e,2048),d=0;var n=!1;setTimeout(function(){n||(n=!0,console.log("File timed out"),onHandledError(`Analysing ...`),l.calculateScores())},1e4),l.on("calc-progress",function(e){sendToMainWindow("calc-progress",e)}),l.on("paths-calculated",function(e){sendToMainWindow("analyse-result",e)}),c.on("finish",function(){n||(n=!0,console.log("Finish reading file"),onHandledError(`Analysing ...`),l.calculateScores())}),c.on("fft",function(e){onHandledError(`Preprocessing ...`),l.fftAvailable(e)}),onHandledError(`File opened: ${u}`),f.pipe(s).pipe(t).pipe(c)}),p.pipe(f)}const e=require("path"),n=require("fs"),o=require("./stream/audioDownsampler.min.js"),r=require("./stream/stereoToMonoReader.min.js"),a=require("./stream/fftWriter.min.js"),i=require("./analyser.min.js");let s,t,c,l,d;console.log("Worker thread started"),process.on("message",function(e){openFile(e.fileName)}),process.stdin.on("data",function(e){console.log("stdin:"+e)});